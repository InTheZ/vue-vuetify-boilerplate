<template lang="pug">

v-container(fill-height, align-center, justify-center)
  v-card(width="480px")
    v-alert(
      dark,
      dismissible,
      color="red",
      transition="slide-y-reverse-transition",
      :value="hasError")
        | {{ error }}
    form(data-test="form", ref="form", @submit.prevent="signup")
      v-card-title.justify-center
        | Sign up
      v-card-text
        v-text-field(
          data-cy="email-input",
          v-model="email",
          v-validate="'required|email|user-availability:email,false'",
          data-vv-delay="350",
          autofocus,
          outlined,
          name="email",
          :error-messages="errors.first('email')",
          label="Email",
          autocomplete="email",
          maxlength="192")
        v-text-field(
          data-cy="username-input",
          v-model="username",
          v-validate="'required|length:5,32|user-availability:username,false'",
          data-vv-delay="350",
          outlined,
          name="username",
          :error-messages="errors.first('username')",
          label="Username",
          autocomplete="username",
          maxlength="32")
        password-field(
          data-cy="password-input",
          v-model="password",
          v-validate="'required|length:5,32'",
          outlined,
          name="password",
          :error-messages="errors.first('password')",
          label="Password",
          autocomplete="new-password",
          maxlength="32",
          counter)
        v-text-field(
          data-cy="name-input",
          v-model="name",
          v-validate="'required'",
          outlined,
          name="name",
          :error-messages="errors.first('name')",
          label="Name",
          autocomplete="name")
      v-card-actions
        v-layout.mx-0(row, reverse)
          v-flex(shrink)
            v-btn.ma-0.text-none(
              data-cy="submit-btn",
              type="submit",
              color="primary"
              :loading="processing",
              @click="signup")
              | Sign up
          v-spacer
          v-flex(shrink)
            v-btn.ma-0.text-none(
              data-cy="login-link",
              text,
              color="primary",
              :disabled="processing",
              :to="{ name: 'sign in' }")
                | Just login

</template>
<script lang="ts" src="./signup.ts">
</script>
